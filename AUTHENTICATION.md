# AicePS ä¼šå‘˜è®¤è¯ç³»ç»Ÿ

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

AicePS ç°å·²é›†æˆå®Œæ•´çš„ä¼šå‘˜ç™»å½•æ³¨å†Œç³»ç»Ÿï¼ŒåŸºäº Supabase Auth æä¾›å®‰å…¨å¯é çš„ç”¨æˆ·è®¤è¯æœåŠ¡ã€‚

## ğŸš€ ä¸»è¦åŠŸèƒ½

### ç”¨æˆ·è®¤è¯
- âœ… **é‚®ç®±å¯†ç ç™»å½•** - æ”¯æŒä¼ ç»Ÿé‚®ç®±å¯†ç è®¤è¯
- âœ… **ç”¨æˆ·æ³¨å†Œ** - æ–°ç”¨æˆ·å¯ä»¥å¿«é€Ÿåˆ›å»ºè´¦æˆ·
- âœ… **å¯†ç é‡ç½®** - å¿˜è®°å¯†ç æ—¶å¯é€šè¿‡é‚®ç®±é‡ç½®
- âœ… **ä¼šè¯æŒä¹…åŒ–** - ç™»å½•çŠ¶æ€è‡ªåŠ¨ä¿æŒ
- âœ… **å®‰å…¨ç™»å‡º** - ä¸€é”®å®‰å…¨é€€å‡ºè´¦æˆ·

### ç•Œé¢ç‰¹æ€§
- ğŸ¨ **è‰ºæœ¯åŒ–è®¾è®¡** - ä¸é¡¹ç›®æ•´ä½“é£æ ¼ä¿æŒä¸€è‡´çš„ç²¾ç¾ç•Œé¢
- ğŸ“± **å“åº”å¼å¸ƒå±€** - å®Œç¾é€‚é…æ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡
- âš¡ **æµç•…åŠ¨ç”»** - ä½¿ç”¨ Framer Motion æä¾›ä¸æ»‘çš„äº¤äº’ä½“éªŒ
- ğŸŒ™ **æ·±è‰²ä¸»é¢˜** - ç¬¦åˆç°ä»£è®¾è®¡è¶‹åŠ¿çš„æ·±è‰²ç•Œé¢
- ğŸ’« **æ¸å˜æ•ˆæœ** - ç²¾å¿ƒè®¾è®¡çš„æ¸å˜è‰²å½©å’Œå…‰å½±æ•ˆæœ

### ç”¨æˆ·ä½“éªŒ
- ğŸ”„ **å®æ—¶çŠ¶æ€** - ç™»å½•çŠ¶æ€å®æ—¶æ›´æ–°ï¼Œæ— éœ€åˆ·æ–°é¡µé¢
- ğŸ¯ **æ™ºèƒ½æç¤º** - å‹å¥½çš„é”™è¯¯æç¤ºå’ŒæˆåŠŸåé¦ˆ
- ğŸš« **è¡¨å•éªŒè¯** - å‰ç«¯å®æ—¶éªŒè¯ï¼Œæå‡ç”¨æˆ·ä½“éªŒ
- ğŸ”’ **å®‰å…¨æ€§** - åŸºäº Supabase çš„ä¼ä¸šçº§å®‰å…¨ä¿éšœ

## ğŸ› ï¸ æŠ€æœ¯å®ç°

### æ ¸å¿ƒæŠ€æœ¯æ ˆ
- **Supabase Auth** - è®¤è¯æœåŠ¡æä¾›å•†
- **React Context** - å…¨å±€çŠ¶æ€ç®¡ç†
- **TypeScript** - ç±»å‹å®‰å…¨ä¿éšœ
- **Framer Motion** - åŠ¨ç”»æ•ˆæœåº“
- **Tailwind CSS** - æ ·å¼æ¡†æ¶

### é¡¹ç›®ç»“æ„
```
/workspace
â”œâ”€â”€ .env                          # ç¯å¢ƒå˜é‡é…ç½®
â”œâ”€â”€ contexts/
â”‚   â””â”€â”€ AuthContext.tsx          # è®¤è¯ä¸Šä¸‹æ–‡
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ Auth.tsx                 # ç™»å½•æ³¨å†Œè¡¨å•
â”‚   â”œâ”€â”€ AuthModal.tsx            # è®¤è¯æ¨¡æ€æ¡†
â”‚   â””â”€â”€ UserMenu.tsx             # ç”¨æˆ·èœå•
â”œâ”€â”€ lib/
â”‚   â””â”€â”€ supabase.ts              # Supabase å®¢æˆ·ç«¯é…ç½®
â”œâ”€â”€ types/
â”‚   â””â”€â”€ supabase.ts              # æ•°æ®åº“ç±»å‹å®šä¹‰
â””â”€â”€ database/
    â””â”€â”€ init.sql                 # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
```

## âš™ï¸ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡
é¡¹ç›®æ ¹ç›®å½•çš„ `.env` æ–‡ä»¶åŒ…å«ä»¥ä¸‹é…ç½®ï¼š
```bash
# Supabase é…ç½®
VITE_SUPABASE_URL=https://uobwbhvwrciaxloqdizc.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# æ•°æ®åº“é…ç½®
SUPABASE_DB_URL=https://uobwbhvwrciaxloqdizc.supabase.co

# å¼€å‘ç¯å¢ƒé…ç½®
PORT=8889
```

### Supabase é…ç½®
- **URL**: `https://uobwbhvwrciaxloqdizc.supabase.co`
- **åŒ¿åå¯†é’¥**: å·²é…ç½®åœ¨ç¯å¢ƒå˜é‡ä¸­
- **è®¤è¯æµç¨‹**: ä½¿ç”¨ PKCE æµç¨‹å¢å¼ºå®‰å…¨æ€§
- **ä¼šè¯æŒä¹…åŒ–**: å¯ç”¨è‡ªåŠ¨ä¼šè¯ä¿æŒ

## ğŸ¯ ä½¿ç”¨æ–¹æ³•

### 1. å¯åŠ¨é¡¹ç›®
```bash
# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆå›ºå®šç«¯å£ 8889ï¼‰
npx netlify dev --port 8889
```

### 2. ç”¨æˆ·æ“ä½œæµç¨‹

#### æ–°ç”¨æˆ·æ³¨å†Œ
1. ç‚¹å‡»é¡µé¢å³ä¸Šè§’çš„ã€Œç™»å½•ã€æŒ‰é’®
2. åœ¨å¼¹å‡ºçš„è®¤è¯çª—å£ä¸­ç‚¹å‡»ã€Œç«‹å³æ³¨å†Œã€
3. è¾“å…¥é‚®ç®±åœ°å€å’Œå¯†ç ï¼ˆè‡³å°‘6ä½ï¼‰
4. ç¡®è®¤å¯†ç å¹¶ç‚¹å‡»ã€Œæ³¨å†Œã€æŒ‰é’®
5. æ ¹æ®é…ç½®ï¼Œå¯èƒ½éœ€è¦é‚®ç®±éªŒè¯

#### ç”¨æˆ·ç™»å½•
1. ç‚¹å‡»é¡µé¢å³ä¸Šè§’çš„ã€Œç™»å½•ã€æŒ‰é’®
2. è¾“å…¥å·²æ³¨å†Œçš„é‚®ç®±å’Œå¯†ç 
3. ç‚¹å‡»ã€Œç™»å½•ã€æŒ‰é’®
4. ç™»å½•æˆåŠŸåä¼šæ˜¾ç¤ºç”¨æˆ·å¤´åƒå’Œèœå•

#### å¯†ç é‡ç½®
1. åœ¨ç™»å½•ç•Œé¢ç‚¹å‡»ã€Œå¿˜è®°å¯†ç ï¼Ÿã€
2. è¾“å…¥æ³¨å†Œæ—¶ä½¿ç”¨çš„é‚®ç®±åœ°å€
3. ç‚¹å‡»ã€Œå‘é€é‡ç½®é“¾æ¥ã€
4. æ£€æŸ¥é‚®ç®±å¹¶æŒ‰ç…§æŒ‡å¼•é‡ç½®å¯†ç 

#### ç”¨æˆ·èœå•
ç™»å½•åç‚¹å‡»å³ä¸Šè§’çš„ç”¨æˆ·å¤´åƒå¯ä»¥ï¼š
- æŸ¥çœ‹ä¸ªäººèµ„æ–™
- è®¿é—®è´¦æˆ·è®¾ç½®
- å®‰å…¨ç™»å‡º

## ğŸ”§ å¼€å‘æŒ‡å—

### åœ¨ç»„ä»¶ä¸­ä½¿ç”¨è®¤è¯çŠ¶æ€
```tsx
import { useAuth } from '../contexts/AuthContext';

const MyComponent = () => {
  const { user, isAuthenticated, isLoading, signOut } = useAuth();
  
  if (isLoading) {
    return <div>åŠ è½½ä¸­...</div>;
  }
  
  if (isAuthenticated) {
    return (
      <div>
        <p>æ¬¢è¿ï¼Œ{user?.email}</p>
        <button onClick={signOut}>ç™»å‡º</button>
      </div>
    );
  }
  
  return <div>è¯·å…ˆç™»å½•</div>;
};
```

### ä¿æŠ¤éœ€è¦ç™»å½•çš„åŠŸèƒ½
```tsx
import { useAuth } from '../contexts/AuthContext';

const ProtectedFeature = () => {
  const { isAuthenticated } = useAuth();
  
  if (!isAuthenticated) {
    return <div>æ­¤åŠŸèƒ½éœ€è¦ç™»å½•åä½¿ç”¨</div>;
  }
  
  return <div>å—ä¿æŠ¤çš„åŠŸèƒ½å†…å®¹</div>;
};
```

## ğŸ—„ï¸ æ•°æ®åº“ç»“æ„

### ç”¨æˆ·é…ç½®è¡¨ (user_profiles)
```sql
CREATE TABLE public.user_profiles (
    id UUID PRIMARY KEY,              -- ç”¨æˆ·ID
    email TEXT UNIQUE NOT NULL,       -- é‚®ç®±åœ°å€
    display_name TEXT,                -- æ˜¾ç¤ºåç§°
    avatar_url TEXT,                  -- å¤´åƒURL
    provider TEXT DEFAULT 'email',    -- è®¤è¯æä¾›å•†
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    last_sign_in TIMESTAMP WITH TIME ZONE,
    preferences JSON DEFAULT '{}'     -- ç”¨æˆ·åå¥½è®¾ç½®
);
```

### ç”¨æˆ·é¡¹ç›®è¡¨ (user_projects)
```sql
CREATE TABLE public.user_projects (
    id UUID PRIMARY KEY,
    user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE,
    project_name VARCHAR(255) NOT NULL,
    project_data JSON DEFAULT '{}',
    thumbnail_url TEXT,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

## ğŸ”’ å®‰å…¨ç‰¹æ€§

### è¡Œçº§å®‰å…¨ç­–ç•¥ (RLS)
- å¯ç”¨äº† Supabase çš„è¡Œçº§å®‰å…¨ç­–ç•¥
- ç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„æ•°æ®
- è‡ªåŠ¨åŒæ­¥ Auth ç”¨æˆ·ä¿¡æ¯

### å‰ç«¯å®‰å…¨
- JWT ä»¤ç‰Œè‡ªåŠ¨ç®¡ç†
- PKCE æµç¨‹é˜²æ­¢æˆæƒç æ‹¦æˆª
- å®‰å…¨çš„ä¼šè¯å­˜å‚¨

### æ•°æ®éªŒè¯
- å‰åç«¯åŒé‡éªŒè¯
- é‚®ç®±æ ¼å¼éªŒè¯
- å¯†ç å¼ºåº¦æ£€æŸ¥

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. ç™»å½•å¤±è´¥
- æ£€æŸ¥é‚®ç®±å’Œå¯†ç æ˜¯å¦æ­£ç¡®
- ç¡®è®¤é‚®ç®±æ˜¯å¦å·²éªŒè¯
- æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°çš„é”™è¯¯ä¿¡æ¯

#### 2. æ³¨å†Œé—®é¢˜
- ç¡®ä¿å¯†ç è‡³å°‘6ä½å­—ç¬¦
- æ£€æŸ¥é‚®ç®±æ ¼å¼æ˜¯å¦æ­£ç¡®
- æŸ¥çœ‹æ˜¯å¦éœ€è¦é‚®ç®±éªŒè¯

#### 3. ç¯å¢ƒé…ç½®
- ç¡®è®¤ `.env` æ–‡ä»¶å­˜åœ¨ä¸”é…ç½®æ­£ç¡®
- æ£€æŸ¥ Supabase URL å’Œå¯†é’¥æ˜¯å¦æœ‰æ•ˆ
- é‡å¯å¼€å‘æœåŠ¡å™¨ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ

### è°ƒè¯•æŠ€å·§
1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·
2. æŸ¥çœ‹ Console æ ‡ç­¾é¡µçš„æ—¥å¿—ä¿¡æ¯
3. æ£€æŸ¥ Network æ ‡ç­¾é¡µçš„ç½‘ç»œè¯·æ±‚
4. æŸ¥çœ‹ Application > Local Storage ä¸­çš„è®¤è¯æ•°æ®

## ğŸ¨ æ ·å¼å®šåˆ¶

### ä¸»è¦ CSS ç±»
- `.auth-form` - è®¤è¯è¡¨å•å®¹å™¨
- `.auth-input` - è¾“å…¥æ¡†æ ·å¼
- `.auth-button` - æŒ‰é’®æ ·å¼
- `.message-error` - é”™è¯¯æ¶ˆæ¯
- `.message-success` - æˆåŠŸæ¶ˆæ¯

### è‡ªå®šä¹‰ä¸»é¢˜
å¯ä»¥é€šè¿‡ä¿®æ”¹ `index.css` ä¸­çš„ CSS å˜é‡æ¥è‡ªå®šä¹‰ä¸»é¢˜ï¼š
```css
:root {
  --auth-primary: #3b82f6;
  --auth-secondary: #1d4ed8;
  --auth-background: rgba(31, 41, 55, 0.8);
}
```

## ğŸ“ˆ æœªæ¥æ‰©å±•

### è®¡åˆ’åŠŸèƒ½
- [ ] ç¤¾äº¤ç™»å½•ï¼ˆGoogleã€GitHubï¼‰
- [ ] å¤šå› ç´ è®¤è¯ (2FA)
- [ ] ç”¨æˆ·èµ„æ–™ç®¡ç†
- [ ] é¡¹ç›®äº‘ç«¯åŒæ­¥
- [ ] ä½¿ç”¨ç»Ÿè®¡åˆ†æ

### API é›†æˆ
- [ ] ç”¨æˆ·åå¥½è®¾ç½® API
- [ ] é¡¹ç›®ç®¡ç† API
- [ ] æ–‡ä»¶ä¸Šä¼  API
- [ ] ä½¿ç”¨ç»Ÿè®¡ API

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹æœ¬æ–‡æ¡£çš„æ•…éšœæ’é™¤éƒ¨åˆ†
2. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°çš„é”™è¯¯ä¿¡æ¯
3. ç¡®è®¤ Supabase æœåŠ¡çŠ¶æ€
4. è”ç³»æŠ€æœ¯å›¢é˜Ÿè·å–æ”¯æŒ

---

**ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025å¹´09æœˆ10æ—¥  
**ç»´æŠ¤å›¢é˜Ÿ**: AicePS å¼€å‘å›¢é˜Ÿ